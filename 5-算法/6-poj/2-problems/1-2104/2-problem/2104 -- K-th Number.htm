<html><head><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta http-equiv="Content-Language" content="en-US"><title>2104 -- K-th Number</title><link rel="stylesheet" href="2104%20--%20K-th%20Number_files/poj.css" type="text/css"><link rel="shortcut icon" href="http://poj.org/poj.ico"><link rel="icon" href="http://poj.org/poj.gif" type="image/gif"><script src="2104%20--%20K-th%20Number_files/ga.js" async="" type="text/javascript"></script><script src="2104%20--%20K-th%20Number_files/poj.js" language="javascript"></script></head><body leftmargin="5" onkeydown="KeyDown(event)" alink="blue" lang="en-US" link="blue" vlink="blue"><a name="top"></a><table style="BORDER-COLLAPSE: collapse" border="1" bordercolor="#ffffff" width="100%"><tbody><tr><td colspan="5" align="CENTER"><table class="h1" cellpadding="0"><tbody><tr><td align="left" width="25%"><img src="2104%20--%20K-th%20Number_files/logo1.jpg" border="0" height="100"></td><td colspan="3" bgcolor="#EAEFFD"><table class="h2"><tbody><tr><td><img src="2104%20--%20K-th%20Number_files/logo0.gif" border="0" height="90" width="450"></td><td width="95"><img src="2104%20--%20K-th%20Number_files/logo3.gif" border="0" height="95" width="95"></td></tr></tbody></table></td></tr></tbody></table></td></tr><tr align="CENTER" bgcolor="#6589d1" valign="top"><th class="h">Online Judge</th><th class="h">Problem Set</th><th class="h">Authors</th><th class="h">Online Contests</th><th class="h">User</th></tr><tr align="CENTER" bgcolor="#f1f1fd" valign="top"><td class="h" onmouseover="scbg(this, 1)" onmouseout="scbg(this, 0)"><a href="http://poj.org/bbs">Web Board</a><br><a href="http://poj.org/">Home Page</a><br><a href="http://poj.org/page?id=1000" target="_blank">F.A.Qs</a><br><a href="http://poj.org/chart">Statistical Charts</a></td><td style="background-color: rgb(241, 241, 253);" class="h" onmouseover="scbg(this, 1)" onmouseout="scbg(this, 0)"><form action="gotoproblem" method="get"><a href="http://poj.org/problemlist">Problems</a><br><a href="http://poj.org/submit">Submit Problem</a><br><a href="http://poj.org/status">Online Status</a><br><font color="blue">Prob.ID:</font><input name="pid" size="6" type="text"><input value="Go" name="pb1" type="Submit"></form></td><td class="h" onmouseover="scbg(this,1)" onmouseout="scbg(this,0)"><form method="GET" action="searchuser"><a href="http://poj.org/register">Register</a><br><a href="http://poj.org/modifyuser">Update your info</a><br><a href="http://poj.org/userlist">Authors ranklist</a><br><input name="key" size="10" type="text"><input value="Search" name="B1" type="Submit"></form></td>
<td class="h" onmouseover="scbg(this,1)" onmouseout="scbg(this,0)"><font color="#1a5cc8">Current Contest</font><br><a href="http://poj.org/pastcontests">Past Contests</a><br><a href="http://poj.org/contests">Scheduled Contests</a><br><a href="http://poj.org/challenge.html" target="_blank"><font color="red">Award Contest</font></a></td><td class="h" onmouseover="scbg(this,1)" onmouseout="scbg(this,0)" align="left"><a href="http://poj.org/userstatus?user_id=loverszhaokai" target="_parent"><b>loverszhaokai</b></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://poj.org/login?action=logout&amp;url=%2Fproblem%3Fid%3D2104">Log Out</a><br><a href="http://poj.org/mail">Mail:1(<b>1</b>)</a><br><a href="http://poj.org/loginlog">Login Log</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="http://poj.org/archive">Archive</a></td></tr></tbody></table><table background="2104%20--%20K-th%20Number_files/table_back.jpg" border="0" width="100%"><tbody><tr><td>
<div style="position: absolute; right: 10px;">Language:<select size="1" onchange="window.location.href='problem?id=2104&amp;lang='+this.value+'&amp;change=true'"><option value="default" selected="selected">Default</option></select></div><div class="ptt" lang="en-US">K-th Number</div>
<div class="plm"><table align="center"><tbody><tr><td><b>Time Limit:</b> 20000MS</td><td width="10px"></td><td><b>Memory Limit:</b> 65536K</td></tr><tr><td><b>Total Submissions:</b> 35702</td><td width="10px"></td><td><b>Accepted:</b> 11396</td></tr><tr><td colspan="3" style="color:#0ead00" align="center"><b>Case Time Limit:</b> 2000MS</td></tr></tbody></table></div><p class="pst">Description</p><div class="ptx" lang="en-US">You
 are working for Macrohard company in data structures department. After 
failing your previous task about key insertion you were asked to write a
 new data structure that would be able to return quickly k-th order 
statistics in the array segment. 
<br>That is, given an array a[1...n] of different integer numbers, your 
program must answer a series of questions Q(i, j, k) in the form: "What 
would be the k-th number in a[i...j] segment, if this segment was 
sorted?" 
<br>For example, consider the array a = (1, 5, 2, 6, 3, 7, 4). Let the 
question be Q(2, 5, 3). The segment a[2...5] is (5, 2, 6, 3). If we sort
 this segment, we get (2, 3, 5, 6), the third number is 5, and therefore
 the answer to the question is 5. </div><p class="pst">Input</p><div class="ptx" lang="en-US">The
 first line of the input file contains n --- the size of the array, and m
 --- the number of questions to answer (1 &lt;= n &lt;= 100 000, 1 &lt;=
 m &lt;= 5 000). 
<br>The second line contains n different integer numbers not exceeding 10<sup>9</sup> by their absolute values --- the array for which the answers should be given. 
<br>The following m lines contain question descriptions, each 
description consists of three numbers: i, j, and k (1 &lt;= i &lt;= j 
&lt;= n, 1 &lt;= k &lt;= j - i + 1) and represents the question Q(i, j, 
k). </div><p class="pst">Output</p><div class="ptx" lang="en-US">For each question output the answer to it --- the k-th number in sorted a[i...j] segment. </div><p class="pst">Sample Input</p><pre class="sio">7 3
1 5 2 6 3 7 4
2 5 3
4 4 1
1 7 3</pre><p class="pst">Sample Output</p><pre class="sio">5
6
3</pre><p class="pst">Hint</p><div class="ptx" lang="en-US">This problem has huge input,so please use c-style input(scanf,printf),or you may got time limit exceed.</div><p class="pst">Source</p><div class="ptx" lang="en-US"><a href="http://poj.org/searchproblem?field=source&amp;key=Northeastern+Europe+2004">Northeastern Europe 2004</a>, Northern Subregion</div></td></tr></tbody></table>
<font color="#333399" size="3"></font><p align="center"><font color="#333399" size="3">
[<a href="http://poj.org/submit?problem_id=2104">Submit</a>]&nbsp;&nbsp;
 [<a href="javascript:history.go(-1)">Go Back</a>]&nbsp;&nbsp; [<a href="http://poj.org/problemstatus?problem_id=2104">Status</a>]&nbsp;&nbsp; 
[<a href="http://poj.org/bbs?problem_id=2104">Discuss</a>]
</font></p>
<p><img src="2104%20--%20K-th%20Number_files/home.gif" border="0" height="30" width="40"><font size="3"><a href="http://poj.org/">Home Page</a> </font>&nbsp;&nbsp;<img src="2104%20--%20K-th%20Number_files/goback.gif" border="0" height="30" width="40"><font size="3"><a href="javascript:history.go(-1)">Go Back</a>&nbsp;&nbsp;<img src="2104%20--%20K-th%20Number_files/top.gif" border="0" height="30" width="40"><a href="#top">To top</a></font><br></p><hr><p style="font-family:Arial, Helvetica, sans-serif" align="center">All Rights Reserved 2003-2013 Ying Fuchen,Xu Pengcheng,Xie Di<br>Any problem, Please <a href="mailto:webmaster@poj.org">Contact Administrator</a></p><script type="text/javascript"> var _gaq = _gaq || []; _gaq.push(['_setAccount', 'UA-790353-1']); _gaq.push(['_trackPageview']); (function() { var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js'; var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s); })(); </script>
</body></html>